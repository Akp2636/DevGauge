generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum Role {
  CANDIDATE
  HR
}

model User {
  id               String            @id @default(uuid())
  role             Role
  name             String
  email            String            @unique
  passwordHash     String
  rankTag          String?           @default("Newbie")
  ratingScore      Int               @default(0)
  createdAt        DateTime          @default(now())
  updatedAt        DateTime          @updatedAt

  candidateProfile CandidateProfile?
  projects         Project[]
  skills           CandidateSkill[]
}

model CandidateProfile {
  id               String   @id @default(uuid())
  userId           String   @unique
  user             User     @relation(fields: [userId], references: [id])
  yearsExperience  Int      @default(0)
  githubUrl        String?
  portfolioUrl     String?
  bio              String?
}

model Skill {
  id               String   @id @default(uuid())
  name             String   @unique
  category         String?
  CandidateSkill   CandidateSkill[]
}

model CandidateSkill {
  id               String   @id @default(uuid())
  userId           String
  skillId          String
  proficiencyScore Int      @default(0)
  isVerified       Boolean  @default(false)
  
  user             User     @relation(fields: [userId], references: [id])
  skill            Skill    @relation(fields: [skillId], references: [id])

  @@unique([userId, skillId])
}

model Project {
  id               String   @id @default(uuid())
  userId           String
  title            String
  description      String
  githubUrl        String?
  aiComplexityScore Int     @default(0)
  aiSummary        String?
  createdAt        DateTime @default(now())
  
  user             User     @relation(fields: [userId], references: [id])
}
